use bjpowernode;
-- select *
-- from EMP;
-- select *
-- from salgrade;
-- select *
-- from dept;
/* ************************************************************************* */
/* 1 取得每个部门最高薪水的人员名称 */
/* 第一步：取得每个部门最高薪水(按照部门编号分组，找出每一组最大值) */
/* select deptno,
 max(sal) as maxsal
 from emp
 group by deptno; */
/* 第二步：将以上的查询结果当做一张临时表t，
 t和emp表连接，条件：t.deptno = e.deptno and t.maxsal = e.sal */
/* select e.ename,
 t.*
 from emp e
 join (
 select deptno,
 max(sal) as maxsal
 from emp
 group by deptno
 ) t on t.deptno = e.deptno
 AND t.maxsal = e.sal; */
/* ************************************************************************* */
/* 2、哪些人的薪水在部门的平均薪水之上 */
/* 第一步先查出每个部门的平均薪水 */
/* select deptno,
 avg(sal) as avgsal
 from emp
 group by deptno; */
/* 第二步：将以上查询结果当做t表，t和emp表连接
 条件：部门编号相同，并且emp的sal大于t表的avgsal */
select t.*,
    e.ename,
    e.sal
from emp e
    join (
        select deptno,
            avg(sal) as avgsal
        from emp
        group by deptno
    ) t on e.deptno = t.deptno
    and e.sal > t.avgsal;
/* ************************************************************************* */
/* 3、取得部门中（所有人的）平均的薪水等级 */
/* ************************************************************************* */
/* 4、不准用组函数（Max ），取得最高薪水 */
/* ************************************************************************* */
/* 5、取得平均薪水最高的部门的部门编号 */
/* ************************************************************************* */
/* 6、取得平均薪水最高的部门的部门名称 */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */