use bjpowernode;
-- select *
-- from EMP;
-- select *
-- from SALGRADE;
-- select *
-- from DEPT;
/* ************************************************************************* */
/* 1 取得每个部门最高薪水的人员名称 */
/* 第一步：取得每个部门最高薪水(按照部门编号分组，找出每一组最大值) */
-- select DEPTNO,
--     max(SAL) as maxsal
-- from EMP
-- group by DEPTNO;
/* 第二步：将以上的查询结果当做一张临时表t，
 t和EMP表连接，条件：t.DEPTNO = e.DEPTNO and t.maxsal = e.SAL */
-- select e.ENAME,
--     t.*
-- from EMP e
--     join (
--         select DEPTNO,
--             max(SAL) as maxsal
--         from EMP
--         group by DEPTNO
--     ) t on t.DEPTNO = e.DEPTNO
--     AND t.maxsal = e.SAL;
/* ************************************************************************* */
/* 2、哪些人的薪水在部门的平均薪水之上 */
/* 第一步先查出每个部门的平均薪水 */
-- select DEPTNO,
--     avg(SAL) as avgsal
-- from EMP
-- group by DEPTNO;
/* 第二步：将以上查询结果当做t表，t和EMP表连接
 条件：部门编号相同，并且EMP的sal大于t表的avgsal */
select t.*,
    e.ENAME,
    e.SAL
from EMP e
    join (
        select DEPTNO,
            avg(SAL) as avgsal
        from EMP
        group by DEPTNO
    ) t on e.DEPTNO = t.DEPTNO
    and e.SAL > t.avgsal;
/* ************************************************************************* */
/* 3、取得部门中（所有人的）平均的薪水等级 */
/* ************************************************************************* */
/* 4、不准用组函数（Max ），取得最高薪水 */
/* ************************************************************************* */
/* 5、取得平均薪水最高的部门的部门编号 */
/* ************************************************************************* */
/* 6、取得平均薪水最高的部门的部门名称 */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */
/* ************************************************************************* */